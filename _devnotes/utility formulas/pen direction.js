//dy and dx are the change in x and y since last pen position.

penVelocityDirection = atan(dy/dx);